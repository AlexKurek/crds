NIRSpec IRS2 readouts produce 3200 pixels in one image dimension. In the native
detector readout orientation it's nx=3200, ny=2048 (i.e. it's a horizontal
rectangle). But all science data and all reference data in CRDS always need to
be in DMS (science) orientation, which for NIRSpec means the x/y axes get
swapped, so that means IRS2 images have nx=2048, ny=3200 (i.e. a vertical
rectangle). Taking a quick look at one of the NIRSpec MASK ref files in CRDS
for IRS2 mode, it correctly shows that the image has dimensions of
2048x3200. So that's the correct orientation you're looking for. If anyone ever
delivers a NIRSpec ref file to CRDS that has dimensions 3200x2048, it's wrong
(it's still in native detector orientation) and needs to be rejected.

The complicating factor in all of this is that a conscious decision was made to
still have the SUBSTRTn keywords (datamodel meta.subarray.[xy]size) retain
their original values of 2048, rather than 3200, because the extra pixels in
the image do not correspond to real pixels on the detector (they're virtual
values inserted into the image). So the detector was still commanded to readout
2048x2048 pixels, hence the decision to make the size keywords still say
2048x2048. Even though ny=3200 in the actual image. So any comparison of
subarray size keyword values against the actual image size needs to allow for
this (i.e. it's OK to have meta.subarray.ysize=2048 when data.shape[-2] =
3200), as long as READPATT has the string "IRS2" somewhere in it.

# -----------------------------------------------------------------------
# For the JWST detectors all reference pixels are physical pixels that are
# counted as part of the detector dimensions (unlike virtual overscan regions
# in CCD's). So the 2048x2048 detector dimensions of the near-IR detectors
# already includes the reference pixels and the MIRI detectors are always
# referenced in the full 1032x1024 space that includes their reference
# pixels. The SUBSTRTn and SUBSIZEn values also always include the reference
# pixels (i.e. SUBSTRT1 = 1 means the subarray is starting on the first
# reference pixel. The first "live" pixel is at SUBSTRT1 = 5.) So for MIRI
# full-frame readouts SUBSIZE1 = 1032, not 1024 (the same as NAXIS1).
#
# The only exception to this is the NIRSpec IRS2 readout mode that includes
# many more columns of reference pixels interspersed within the live pixels,
# resulting in total image dimensions that are greater than 2048 (at least
# along the y image axis). So this is the only case where SUBSIZEn != NAXISn,
# because NAXIS2 2048, while a decision was made to still set SUBSIZE2 = 2048.


# --------------------------------------------------------------------------


Comments about array dimensions and array shape equivalence:

DARK: non-MIRI: SCI=ERR=3D, DQ=2D; MIRI: SCI=ERR=DQ=4D

LINEARITY: COEFFS=3D, DQ=2D

